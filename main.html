<!DOCTYPE html>
<html>
  <head>
    <title>Swamp Thing</title>
    <style>
      #iswork {
      background:#00ff00;
      }

      .active {
      background:#00ff00;
      }
      .inactive {
      background:#ff0000;
      }
    </style>
  </head>
  <body>
    <h1>Status</h1>
    Logged in as <div style="display:inline;" id="name">{{name}}</div> <br>

    Are you working?
    <form id='work'>
      <input type="radio" id="iswork"  name="working" value="yes" style="background:green;">Yes</input>
      <input type="radio" id="nowork"  name="working" value="no" style="background:red;" selected>No</input>
    </form>

    <table id="window">
    </table>
    <div id="extra"></div>
    <script type="text/javascript" src="/jquery.min.js"></script>
    <script>
      setInterval(function () {
       var status = document.getElementById("iswork").checked;
       $.ajax({url : '/ajax?name='+$('#name').text()+'&status='+ (status ? 1 : 0), 
                cache:false, type:'GET', 
                success: function (data) {
                  table = $('#window');
                  table.empty();
                  table.append("<tr><th><th>Measures<th>");
                  table.append("<tr><th>Name<th>Today<th>All<th>Current<th>Status");
	          for (var i = 0; i < data.names.length; ++i) {
	            table.append('<tr class="' + (data.status[data.names[i]] ? 'active' : 'inactive') +
				     '"><td>'+data.names[i]+'<td>' +
				      data.today[data.names[i]] + '<td>' +
				      data.measures[data.names[i]] + '<td>' +
				      data.current[data.names[i]] +'<td>' +
				      data.status[data.names[i]]);
	          }
                  //$("#extra").empty();
                  //$("#extra").append(data.simple);
		  if (data.finished) { document.getElementById("nowork").checked = true; } 
                }});
              },1000);
    </script>
  </body>
</html>

